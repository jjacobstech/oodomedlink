import{r as b,a as w,g as l,e as g,b as i,p as z,w as V,f as o,t as p,o as n,F as y,h as k,i as f,n as C,s as x,q as _,v as P,z as F,l as D,c as L,A as M,y as W}from"./app-p2iobxpo.js";import{u as G,o as E,e as S,s as h,_ as H,a as J,f as q}from"./schemas-CXED7JQI.js";import{_ as K}from"./AdminAuthLayout.vue_vue_type_script_setup_true_lang-BVW0W3Nr.js";import"./x-CPPi54FQ.js";import"./index-DQRDA4b2.js";import"./ApplicationLogo.vue_vue_type_script_setup_true_lang-DsY41qYV.js";import"./Wind-LiKkUfSx-BowAPz5r.js";const Q={class:"flex h-screen items-center justify-center overflow-y-hidden"},X={class:"max-w-lg items-center justify-center rounded-xl bg-white shadow-xl"},Y={class:"bg-deepgradient grid space-y-1 rounded-t-lg p-6"},Z={class:"text-center text-white"},ee={class:"flex justify-center py-6"},te={class:"px-auto flex items-center justify-between"},oe={class:"flex items-center"},se={class:"space-y-4 p-6"},ae={class:"space-y-2"},re=["disabled"],ie={class:"mt-6 text-center"},ne={class:"text-sm text-gray-600"},le={class:"space-y-2"},de={class:"mb-2 text-xs text-gray-500"},ce=["disabled"],ue={class:"mt-4 text-center"},me=["disabled"],pe=["for"],he=["id","type","placeholder","autocomplete","onUpdate:modelValue"],ge=["disabled"],Se={__name:"Register",setup(fe){const R=W,s=b(!1),d=b(1),{toast:r}=G(),j=sessionStorage.getItem("email"),c=w({email:""}),u=w({otp:"",email:""}),N=b([{id:"name",name:"Name",placeholder:"Enter your name",type:"text",required:!0,autocomplete:"organization",model:"name"},{id:"phone_no",name:"Phone Number",placeholder:"Enter your phone number",type:"tel",required:!0,autocomplete:"tel",model:"phone_no"},{id:"password",name:"Password",placeholder:"Create a password",type:"password",required:!0,autocomplete:"new-password",model:"password"},{id:"password_confirmation",name:"Confirm Password",placeholder:"Confirm your password",type:"password",required:!0,autocomplete:"new-password",model:"password_confirmation"}]),m=w({email:"",name:"",phone_no:"",password:"",password_confirmation:""}),T=E({email:S("Invalid email address").min(1,"Email is required")}),U=E({otp:h().length(6,"OTP must be 6 digits"),email:S("Invalid email address")}),I=E({name:h().min(1,"Clinic name is required"),email:S("Invalid email address"),phone_no:h().min(1,"Phone number is required"),password:h().min(6,"Password must be at least 6 characters"),password_confirmation:h().min(6,"Password confirmation is required")}).refine(a=>a.password===a.password_confirmation,{message:"Passwords don't match",path:["password_confirmation"]});c.email=j;const A=async()=>{s.value=!0,sessionStorage.clear();const a=T.safeParse(c);if(!a.success){const e=a.error.errors[0];r({title:"Validation Error",description:e.message,variant:"destructive",class:"text-deepblue bg-white shadow-lg"}),s.value=!1;return}try{c.post(route("admin.send.otp"),{onSuccess:e=>{r({title:"Verification Code Sent",description:"Please check your email for the verification code",class:"text-deepblue bg-white shadow-lg"}),d.value=2,u.email=c.email},onError:e=>{r({title:"Error",description:e.email||"Failed to send verification code",variant:"destructive",class:"text-deepblue bg-white shadow-lg"}),s.value=!1}})}catch(e){console.error(e)}s.value=!1},B=async()=>{console.log(u.email),s.value=!0;const a=U.safeParse(u);if(!a.success){for(const e in q(a.error)?.fieldErrors){const t=q(a.error)?.fieldErrors[e][0];r({title:"Validation Error",description:t,variant:"destructive",class:"text-deepblue bg-white shadow-lg"})}s.value=!1;return}try{u.post(route("admin.verify.otp"),{onSuccess:e=>{r({title:"Email Verified",description:"Please complete your registration",class:"text-deepblue bg-white shadow-lg"}),m.email=u.email,d.value=3},onError:e=>{r({title:"Verification Failed",description:e.otp||"Invalid verification code",variant:"destructive",class:"text-deepblue bg-white shadow-lg"}),console.log(e)}})}catch(e){console.error(e)}s.value=!1},O=async()=>{s.value=!0,console.log(u.email);try{c.post(route("admin.send-otp"),{onSuccess:()=>{r({title:"Code Resent",description:"A new verification code has been sent to your email",class:"text-deepblue bg-white shadow-lg"})},onError:()=>{r({title:"Error",description:"Failed to resend verification code",variant:"destructive",class:"text-deepblue bg-white shadow-lg"})}})}catch(a){console.error(a)}s.value=!1},$=async()=>{s.value=!0,console.log(m.email);const a=I.safeParse(m);if(!a.success){const e=a.error.flatten().fieldErrors;for(const t in e){r({title:"Validation Error",description:e[t][0],variant:"destructive",class:"text-deepblue bg-white shadow-lg"});break}s.value=!1;return}try{m.post(route("admin.signup"),{onError:e=>{for(const t in e){r({title:"Registration Failed",description:e[t],variant:"destructive",class:"text-deepblue bg-white shadow-lg"});break}},onSuccess:()=>{r({title:"Registration Successful",description:"Welcome! Redirecting to dashboard...",class:"text-deepblue bg-white shadow-lg"}),setTimeout(()=>{R.push(route("admin.dashoard"))},500)}})}catch(e){console.error(e)}s.value=!1};return(a,e)=>(n(),l(y,null,[g(i(z),{title:"signup"}),g(K,null,{default:V(()=>[g(H),o("div",Q,[o("div",X,[o("div",Y,[e[2]||(e[2]=o("h2",{class:"text-center text-2xl font-bold text-white"}," Complete Registration ",-1)),o("p",Z," Create an account - Step "+p(d.value)+" of 3 ",1)]),o("div",ee,[o("div",te,[(n(),l(y,null,k(3,t=>o("div",{key:t,class:"flex-1"},[o("div",oe,[o("div",{class:C(["flex h-8 w-8 items-center justify-center rounded-full text-sm font-medium transition-all",d.value>=t?"bg-deepgradient text-white":"bg-gray-200 text-gray-500"])},p(t),3),t<3?(n(),l("div",{key:0,class:C(["mx-2 h-1 w-20 flex-1 transition-all",d.value>t?"bg-deepgradient":"bg-gray-200"])},null,2)):f("",!0)])])),64))])]),o("div",se,[d.value===1?(n(),l("form",{key:0,onSubmit:x(A,["prevent"]),class:"space-y-4"},[o("div",ae,[e[3]||(e[3]=o("label",{for:"email",class:"text-sm font-medium"},"Email Address",-1)),_(o("input",{id:"email",type:"email",placeholder:"Enter your email",autocomplete:"email",autofocus:"","onUpdate:modelValue":e[0]||(e[0]=t=>i(c).email=t),class:"focus:ring-deepgreen w-full rounded-md border border-gray-300 px-3 py-2 focus:outline-none focus:ring-2"},null,512),[[P,i(c).email]])]),o("button",{type:"submit",class:"bg-deepgradient hover:shadow-deepgreen/30 w-full rounded-lg px-4 py-2.5 font-medium text-white transition-all duration-200 hover:-translate-y-1 hover:bg-white hover:shadow-md disabled:cursor-not-allowed disabled:opacity-50",disabled:s.value},p(s.value?"Sending OTP...":"Send Verification Code"),9,re),o("div",ie,[o("p",ne,[e[5]||(e[5]=F(" Already have an account? ",-1)),g(i(D),{href:a.route("admin.login"),class:"text-deepgreen hover:text-deepgreen/80 font-medium transition-colors"},{default:V(()=>[...e[4]||(e[4]=[F(" Login ",-1)])]),_:1},8,["href"])])])],32)):f("",!0),d.value===2?(n(),l("form",{key:1,onSubmit:x(B,["prevent"]),class:"space-y-4"},[o("div",le,[e[6]||(e[6]=o("label",{for:"otp",class:"text-sm font-medium"},"Verification Code",-1)),o("p",de," Enter the 6-digit code sent to "+p(i(c).email),1),_(o("input",{id:"otp",type:"text",placeholder:"Enter 6-digit code",maxlength:"6","onUpdate:modelValue":e[1]||(e[1]=t=>i(u).otp=t),class:"focus:ring-deepgreen w-full rounded-md border border-gray-300 px-3 py-2 text-center text-2xl tracking-widest focus:outline-none focus:ring-2"},null,512),[[P,i(u).otp]])]),o("button",{type:"submit",class:"bg-deepgradient hover:shadow-deepgreen/30 w-full rounded-lg px-4 py-2.5 font-medium text-white transition-all duration-200 hover:-translate-y-1 hover:bg-white hover:shadow-md disabled:cursor-not-allowed disabled:opacity-50",disabled:s.value},p(s.value?"Verifying...":"Verify Code"),9,ce),o("div",ue,[o("button",{type:"button",onClick:O,class:"text-deepgreen hover:text-deepgreen/80 text-sm transition-colors",disabled:s.value}," Resend Code ",8,me)])],32)):f("",!0),d.value===3?(n(),l("form",{key:2,onSubmit:x($,["prevent"]),class:"h-full space-y-4"},[(n(!0),l(y,null,k(N.value,t=>(n(),l("div",{class:"space-y-2",key:t.id},[o("label",{for:t.id,class:"text-sm font-medium"},p(t.name),9,pe),t.type!=="password"?_((n(),l("input",{key:0,id:t.id,type:t.type,placeholder:t.placeholder,autocomplete:t.autocomplete,"onUpdate:modelValue":v=>i(m)[t.model]=v,class:"focus:ring-deepgreen w-full rounded-md border border-gray-300 px-3 py-2 focus:outline-none focus:ring-2"},null,8,he)),[[M,i(m)[t.model]]]):(n(),L(J,{key:1,id:t.id,placeholder:t.placeholder,modelValue:i(m)[t.model],"onUpdate:modelValue":v=>i(m)[t.model]=v},null,8,["id","placeholder","modelValue","onUpdate:modelValue"]))]))),128)),o("button",{type:"submit",class:"bg-deepgradient hover:shadow-deepgreen/30 w-full rounded-lg px-4 py-2.5 font-medium text-white transition-all duration-200 hover:-translate-y-1 hover:bg-white hover:shadow-md disabled:cursor-not-allowed disabled:opacity-50",disabled:s.value},p(s.value?"Signing up...":"Complete Registration"),9,ge)],32)):f("",!0)])])])]),_:1})],64))}};export{Se as default};
