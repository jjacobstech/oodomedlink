import{d as C,u as $,r as x,m as j,g as o,e as _,b as S,p as E,w as D,f as t,i as c,n as d,q as L,v as V,o as n,F as m,h,t as a,z as y}from"./app-Ji7o7nMj.js";import{_ as z}from"./AuthenticatedLayout.vue_vue_type_script_setup_true_lang-tvIg3WMm.js";import"./index-DmzfpGfi.js";import"./x-DaoxGN1F.js";import"./index-oC-JvPDr.js";import"./ApplicationLogo.vue_vue_type_script_setup_true_lang-BgReUAX0.js";import"./Wind-LiKkUfSx-CajI83YB.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const F={class:"h-full w-full bg-gray-100"},N={class:"overflow-y-scroll p-6"},P={class:"mb-6 flex flex-col gap-4 md:flex-row md:items-center md:justify-between"},R={class:"flex gap-2"},A={class:"relative"},B={class:"overflow-x-auto rounded-xl bg-white shadow-md"},M={class:"w-full text-sm"},T={class:"divide-y divide-gray-200"},q={class:"px-4 py-3 font-medium text-gray-800"},I={class:"px-4 py-3 text-gray-700"},U={class:"max-w-[200px] truncate px-4 py-3 text-gray-700"},Q={class:"px-4 py-3 text-gray-600"},G={class:"px-4 py-3"},H={class:"px-4 py-3"},J={class:"flex gap-2"},K=["onClick"],O=["onClick"],W={key:0},X={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"},Y={class:"w-full max-w-4xl p-6 bg-white rounded-xl max-h-[90vh] overflow-y-auto"},Z={class:"mb-4 flex items-center justify-between"},tt={class:"text-2xl font-bold text-gray-800"},et={class:"mb-4 text-sm text-gray-600"},st={class:"rounded-lg bg-gray-50 p-4 text-gray-700"},lt={key:0,class:"text-center"},ot=["src"],nt=["onClick"],at={key:1,class:"text-center w-full"},rt=["src"],it=["onClick"],dt={key:2,class:"text-center"},ut=["onClick"],_t=C({__name:"Emails",props:{emails:{}},setup(w){$().props.ziggy.base_url;const b=w;console.log(b);const r=x("all"),u=x(""),i=x(null),g=l=>{window.open(l.file_url,"_blank")},f=j(()=>{let l=b.emails;if(r.value!=="all"&&(l=l?.filter(e=>e.status===r.value)),u.value){const e=u.value.toLowerCase();l=l?.filter(s=>s.patient.full_name.toLowerCase().includes(e)||s.patient_email.toLowerCase().includes(e)||s.subject.toLowerCase().includes(e))}return l}),v=l=>new Date(l).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),k=l=>{alert(`Retrying email to ${l.patient_email}...`)};return(l,e)=>(n(),o(m,null,[_(S(E),{title:"Email Management"}),_(z,null,{default:D(()=>[t("div",F,[t("div",N,[e[14]||(e[14]=t("div",{class:"mb-6"},[t("h1",{class:"text-3xl font-bold text-gray-800"}," Patient Emails "),t("p",{class:"text-gray-600"}," Monitor and manage all sent emails to patients ")],-1)),t("div",P,[t("div",R,[t("button",{onClick:e[0]||(e[0]=s=>r.value="all"),class:d([r.value==="all"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700","rounded-lg px-4 py-2 font-medium transition-colors"])}," All ",2),t("button",{onClick:e[1]||(e[1]=s=>r.value="in_progress"),class:d([r.value==="in_progress"?"bg-orange-600 text-white":"bg-gray-200 text-gray-700","rounded-lg px-4 py-2 font-medium transition-colors"])}," In Progress ",2),t("button",{onClick:e[2]||(e[2]=s=>r.value="sent"),class:d([r.value==="sent"?"bg-green-600 text-white":"bg-gray-200 text-gray-700","rounded-lg px-4 py-2 font-medium transition-colors"])}," Sent ",2),t("button",{onClick:e[3]||(e[3]=s=>r.value="failed"),class:d([r.value==="failed"?"bg-red-600 text-white":"bg-gray-200 text-gray-700","rounded-lg px-4 py-2 font-medium transition-colors"])}," Failed ",2)]),t("div",A,[L(t("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>u.value=s),type:"text",placeholder:"Search by patient, email, or subject...",class:"w-full rounded-lg border border-gray-300 px-4 py-2 pl-10 focus:border-transparent focus:ring-2 focus:ring-blue-500 md:w-80"},null,512),[[V,u.value]]),e[6]||(e[6]=t("span",{class:"absolute left-3 top-1/2 -translate-y-1/2 transform text-gray-400"},"ðŸ”",-1))])]),t("div",B,[t("table",M,[e[8]||(e[8]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-4 py-3 text-left text-xs font-semibold uppercase text-gray-700"}," Patient "),t("th",{class:"px-4 py-3 text-left text-xs font-semibold uppercase text-gray-700"}," Email "),t("th",{class:"px-4 py-3 text-left text-xs font-semibold uppercase text-gray-700"}," Subject "),t("th",{class:"px-4 py-3 text-left text-xs font-semibold uppercase text-gray-700"}," Sent At "),t("th",{class:"px-4 py-3 text-left text-xs font-semibold uppercase text-gray-700"}," Status "),t("th",{class:"px-4 py-3 text-left text-xs font-semibold uppercase text-gray-700"}," Actions ")])],-1)),t("tbody",T,[(n(!0),o(m,null,h(f.value,s=>(n(),o("tr",{key:s.id,class:"hover:bg-gray-50"},[t("td",q,a(s.patient.full_name),1),t("td",I,a(s.patient.email),1),t("td",U,a(s.subject),1),t("td",Q,a(v(s.sent_at)),1),t("td",G,[t("span",{class:d([{"bg-green-100 text-green-800":s.status==="sent","bg-red-100 text-red-800":s.status==="failed","bg-orange-100 text-orange-800":s.status==="in_progress"},"rounded-full px-3 py-1 text-xs font-semibold capitalize"])},a(s.status.replace("_"," ")),3)]),t("td",H,[t("div",J,[t("button",{onClick:p=>i.value=s,class:"rounded bg-blue-100 px-3 py-1 text-xs font-medium text-blue-700 transition hover:bg-blue-200"}," View ",8,K),s.status==="failed"?(n(),o("button",{key:0,onClick:p=>k(s),class:"rounded bg-red-100 px-3 py-1 text-xs font-medium text-red-700 transition hover:bg-red-200"}," Retry ",8,O)):c("",!0)])])]))),128)),f.value?.length===0?(n(),o("tr",W,[...e[7]||(e[7]=[t("td",{colspan:"6",class:"px-4 py-8 text-center text-gray-500"}," No emails found. ",-1)])])):c("",!0)])])]),i.value?(n(),o("div",X,[t("div",Y,[t("div",Z,[t("h3",tt,a(i.value.subject),1),t("button",{onClick:e[5]||(e[5]=s=>i.value=null),class:"rounded-lg bg-gray-200 px-4 py-2 text-gray-700 hover:bg-gray-300"}," Close ")]),t("div",et,[t("p",null,[e[9]||(e[9]=t("strong",null,"To:",-1)),y(" "+a(i.value.patient.full_name)+" ("+a(i.value.patient_email)+") ",1)]),t("p",null,[e[10]||(e[10]=t("strong",null,"Sent:",-1)),y(" "+a(v(i.value.sent_at)),1)]),t("p",null,[e[11]||(e[11]=t("strong",null,"Status:",-1)),y(" "+a(i.value.status),1)])]),t("div",st,[t("p",null,a(i.value.message_preview),1)]),(n(!0),o(m,null,h(i.value.result.files,s=>(n(),o("div",{key:s.id,class:"flex items-center justify-center p-8 my-2 bg-gray-100 rounded-lg"},[s.file_type==="image/png"||s.file_type==="image/jpg"||s.file_type==="image/jpeg"?(n(),o("div",lt,[t("img",{src:s.file_url,alt:"Result preview",class:"max-w-full max-h-96"},null,8,ot),t("button",{onClick:p=>g(s),class:"px-4 py-2 mt-4 font-semibold text-white bg-blue-600 rounded-lg hover:bg-blue-700"}," Download Image ",8,nt)])):s.file_type==="application/pdf"?(n(),o("div",at,[t("iframe",{src:s.file_url,frameborder:"10",class:"w-full h-96"},null,8,rt),t("button",{onClick:p=>g(s),class:"px-4 py-2 mt-4 font-semibold text-white bg-blue-600 rounded-lg hover:bg-blue-700"}," Download ",8,it)])):(n(),o("div",dt,[e[12]||(e[12]=t("span",{class:"text-6xl"},"ðŸ“Š",-1)),e[13]||(e[13]=t("p",{class:"mt-4 text-gray-600"}," File",-1)),t("button",{onClick:p=>g(s),class:"px-4 py-2 mt-4 font-semibold text-white bg-blue-600 rounded-lg hover:bg-blue-700"}," Download ",8,ut)]))]))),128))])])):c("",!0)])])]),_:1})],64))}});export{_t as default};
