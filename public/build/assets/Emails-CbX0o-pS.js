import{d as E,r as y,g as o,e as S,b as M,m as P,w as B,f as t,n as u,o as n,F as m,h as b,p,t as l,q as N,v as V,x as f,s as R,z as v,a as A}from"./app-Di8en0WK.js";import{_ as T}from"./AuthenticatedLayout.vue_vue_type_script_setup_true_lang-BESfscOU.js";import"./index-CABOEtuX.js";import"./x-LOMyNgZq.js";import"./index-whAlchlW.js";import"./createLucideIcon-BxaQ1Zoa.js";import"./ApplicationLogo.vue_vue_type_script_setup_true_lang-iTrJ2Lib.js";import"./Wind-LiKkUfSx-DFiPfxH6.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-BsyDEdYY.js";const K={class:"flex w-full gap-1 h-full overflow-y-hidden bg-primaryLight"},L={class:"overflow-y-scroll w-full p-4 sm:p-6"},U={class:"mb-6 flex flex-col gap-4 lg:flex-row lg:items-center lg:justify-between"},q={class:"flex flex-wrap gap-2"},G=["onClick"],Q={class:"flex flex-col sm:flex-row gap-2 w-full lg:w-auto"},H={class:"relative flex-1 lg:flex-initial"},I={class:"flex gap-2"},J={class:"mb-4 text-xs sm:text-sm text-gray-600"},O={class:"lg:hidden space-y-4"},W={class:"flex justify-between items-start"},X={class:"flex-1 min-w-0"},Y={class:"text-sm text-gray-600 truncate"},Z={class:"space-y-1 text-sm"},tt={class:"text-gray-700 truncate"},et={class:"text-gray-600 text-xs"},st={class:"flex gap-2 pt-2"},lt=["onClick"],at=["onClick","disabled"],ot={key:0,class:"bg-white rounded-xl shadow-md p-8 text-center text-gray-500"},nt={class:"hidden lg:block overflow-x-auto rounded-xl bg-white shadow-md"},rt={class:"w-full text-sm"},it={class:"divide-y divide-gray-200"},dt={class:"max-w-[200px] truncate px-4 py-3 text-gray-700"},ut={class:"px-4 py-3 text-gray-600"},ct={class:"px-4 py-3"},xt={class:"px-4 py-3"},pt={class:"flex gap-2"},gt=["onClick"],mt=["onClick","disabled"],yt={key:0},bt={key:0,class:"mt-6 flex flex-col sm:flex-row items-center justify-between gap-4"},ft=["disabled"],vt={class:"text-sm text-gray-600"},ht=["disabled"],_t={class:"w-full max-w-4xl bg-white rounded-xl max-h-[90vh] overflow-y-auto"},wt={class:"sticky top-0 bg-white border-b border-gray-200 p-4 sm:p-6 flex items-start justify-between gap-4"},kt={class:"text-lg sm:text-2xl font-bold text-gray-800 break-words flex-1"},Ct={class:"p-4 sm:p-6 space-y-6"},Dt={class:"text-sm sm:text-base text-gray-600 space-y-2"},St={class:"break-words"},jt={key:0},$t={class:"rounded-lg bg-gray-50 p-4 text-sm sm:text-base text-gray-700"},Ft={class:"whitespace-pre-wrap break-words"},zt={key:0,class:"space-y-4"},Et={class:"text-base sm:text-lg font-semibold text-gray-800"},Mt={key:0,class:"text-center space-y-4"},Pt=["src","alt"],Bt={class:"flex flex-col sm:flex-row gap-2 justify-center"},Nt={class:"text-sm text-gray-600 break-all"},Vt=["onClick"],Rt={key:1,class:"space-y-4"},At=["src"],Tt={class:"flex flex-col sm:flex-row gap-2 justify-center items-center"},Kt={class:"text-sm text-gray-600 break-all text-center"},Lt=["onClick"],Ut={key:2,class:"text-center space-y-4"},qt={class:"text-sm sm:text-base text-gray-600 font-medium break-all px-4"},Gt={class:"text-xs sm:text-sm text-gray-500"},Qt=["onClick"],se=E({__name:"Emails",props:{emails:{},search:{},filter:{},error:{}},setup(i){const k=i,x=y(k.filter||"all"),g=y(k.search||""),a=y(null),j=["all","pending","sent","failed","scheduled"],c=y(null),h=r=>{window.open(r.file_url,"_blank")},_=r=>{r!==void 0&&(x.value=r);const s={};x.value&&x.value!=="all"&&(s.filter=x.value),g.value&&g.value.trim()!==""&&(s.search=g.value.trim()),v.get(route("user.emails"),s,{preserveScroll:!0,preserveState:!0,onError:e=>{}})},$=()=>{x.value="all",g.value="",v.get(route("user.emails"),{},{preserveScroll:!0,preserveState:!0})},C=r=>{r&&v.get(r,{},{preserveScroll:!0,preserveState:!0})},w=r=>new Date(r).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),D=r=>{if(c.value)return;c.value=r.id,A({id:r.id}).post(route("user.email.retry"),{onSuccess:()=>{c.value=null,v.reload({only:["emails","filter"]})},onError:e=>{c.value=null},preserveScroll:!0,preserveUrl:x.value!=="all"})},F=r=>{r.key==="Enter"&&_()},z=r=>{if(r===0)return"0 Bytes";const s=1024,e=["Bytes","KB","MB","GB"],d=Math.floor(Math.log(r)/Math.log(s));return Math.round(r/Math.pow(s,d)*100)/100+" "+e[d]};return(r,s)=>(n(),o(m,null,[S(M(P),{title:"Email Management"}),S(T,null,{default:B(()=>[t("div",K,[t("div",L,[s[16]||(s[16]=t("div",{class:"mb-6"},[t("h1",{class:"text-2xl sm:text-3xl font-bold text-gray-800"}," Patient Emails "),t("p",{class:"text-sm sm:text-base text-gray-600 mt-1"}," Monitor and manage all sent emails to patients ")],-1)),t("div",U,[t("div",q,[(n(),o(m,null,b(j,e=>t("button",{key:e,onClick:d=>_(e),class:p([x.value===e?"bg-primaryDark text-white":"bg-gray-200 text-gray-700","px-3 sm:px-4 py-1.5 sm:py-2 text-xs sm:text-sm font-medium rounded-lg transition-all hover:shadow-md capitalize"])},l(e),11,G)),64))]),t("div",Q,[t("div",H,[N(t("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>g.value=e),type:"text",placeholder:"Search by patient name...",onKeydown:F,class:"w-full rounded-lg border border-gray-300 px-4 py-2 pl-10 text-sm focus:border-transparent focus:ring-2 focus:ring-primaryDark lg:w-80"},null,544),[[V,g.value]]),s[6]||(s[6]=t("span",{class:"absolute left-3 top-1/2 -translate-y-1/2 transform text-gray-400"},"ðŸ”",-1))]),t("div",I,[t("button",{onClick:s[1]||(s[1]=e=>_()),class:"flex-1 sm:flex-initial px-4 py-2 text-sm font-semibold text-white bg-primaryDark rounded-lg hover:bg-primaryDark/90 hover:shadow-lg transition whitespace-nowrap"}," Search "),t("button",{onClick:$,class:"flex-1 sm:flex-initial px-4 py-2 text-sm font-semibold text-white bg-gray-600 rounded-lg hover:bg-gray-700 hover:shadow-lg transition whitespace-nowrap"}," Clear ")])])]),t("div",J,[t("p",null," Showing "+l(i.emails.from||0)+" to "+l(i.emails.to||0)+" of "+l(i.emails.total)+" emails ",1)]),t("div",O,[(n(!0),o(m,null,b(i.emails.data,e=>(n(),o("div",{key:e.id,class:"bg-white rounded-xl shadow-md p-4 space-y-3"},[t("div",W,[t("div",X,[t("h3",{class:p(["font-semibold text-gray-800 truncate",e.patient?"text-gray-800":"text-red-800"])},l(e.patient===null?"Deleted Patient":e.patient.full_name),3),t("p",Y,l(e.patient===null?"Deleted Patient":e.patient.email),1)]),t("span",{class:p([{"bg-green-100 text-green-800":e.status==="sent","bg-red-100 text-red-800":e.status==="failed","bg-orange-100 text-orange-800":e.status==="pending","bg-primaryDark text-white":e.status==="scheduled"},"rounded-full px-2.5 py-1 text-xs font-semibold capitalize whitespace-nowrap ml-2"])},l(e.status),3)]),t("div",Z,[t("p",tt,[s[7]||(s[7]=t("span",{class:"font-medium"},"Subject:",-1)),f(" "+l(e.subject),1)]),t("p",et,l(w(e.sent_at)),1)]),t("div",st,[e.patient?(n(),o("button",{key:0,onClick:d=>a.value=e,class:"flex-1 rounded-lg bg-blue-100 px-3 py-2 text-sm font-medium text-blue-700 transition hover:bg-blue-200"}," View Details ",8,lt)):u("",!0),e.status==="failed"||e.status==="scheduled"?(n(),o("button",{key:1,onClick:d=>D(e),disabled:c.value===e.id,class:"flex-1 rounded-lg bg-red-100 px-3 py-2 text-sm font-medium text-red-700 transition hover:bg-red-200 disabled:opacity-50 disabled:cursor-not-allowed"},l(c.value===e.id?"Retrying...":"Retry"),9,at)):u("",!0)])]))),128)),i.emails.data.length===0?(n(),o("div",ot,[...s[8]||(s[8]=[t("div",{class:"text-4xl mb-2"},"ðŸ“§",-1),t("p",null,"No emails found.",-1)])])):u("",!0)]),t("div",nt,[t("table",rt,[s[10]||(s[10]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-4 py-3 text-left text-xs font-semibold uppercase text-gray-700"}," Patient "),t("th",{class:"px-4 py-3 text-left text-xs font-semibold uppercase text-gray-700"}," Email "),t("th",{class:"px-4 py-3 text-left text-xs font-semibold uppercase text-gray-700"}," Subject "),t("th",{class:"px-4 py-3 text-left text-xs font-semibold uppercase text-gray-700"}," Sent At "),t("th",{class:"px-4 py-3 text-left text-xs font-semibold uppercase text-gray-700"}," Status "),t("th",{class:"px-4 py-3 text-left text-xs font-semibold uppercase text-gray-700"}," Actions ")])],-1)),t("tbody",it,[(n(!0),o(m,null,b(i.emails.data,e=>(n(),o("tr",{key:e.id,class:"hover:bg-gray-50"},[t("td",{class:p(["px-4 py-3 font-medium",e.patient?"text-gray-800":"text-red-800"])},l(e.patient===null?"Deleted Patient":e.patient.full_name),3),t("td",{class:p(["px-4 py-3 font-medium",e.patient?"text-gray-800":"text-red-800"])},l(e.patient===null?"Deleted Patient":e.patient.email),3),t("td",dt,l(e.subject),1),t("td",ut,l(w(e.sent_at)),1),t("td",ct,[t("span",{class:p([{"bg-green-100 text-green-800":e.status==="sent","bg-red-100 text-red-800":e.status==="failed","bg-orange-100 text-orange-800":e.status==="pending","bg-primaryDark text-white":e.status==="scheduled"},"rounded-full px-3 py-1 text-xs font-semibold capitalize"])},l(e.status),3)]),t("td",xt,[t("div",pt,[e.patient?(n(),o("button",{key:0,onClick:d=>a.value=e,class:"rounded bg-blue-100 px-3 py-1 text-xs font-medium text-blue-700 transition hover:bg-blue-200"}," View ",8,gt)):u("",!0),e.status==="failed"||e.status==="scheduled"?(n(),o("button",{key:1,onClick:d=>D(e),disabled:c.value===e.id,class:"rounded bg-red-100 px-3 py-1 text-xs font-medium text-red-700 transition hover:bg-red-200 disabled:opacity-50 disabled:cursor-not-allowed"},l(c.value===e.id?"Retrying...":"Retry"),9,mt)):u("",!0)])])]))),128)),i.emails.data.length===0?(n(),o("tr",yt,[...s[9]||(s[9]=[t("td",{colspan:"6",class:"px-4 py-8 text-center text-gray-500"}," No emails found. ",-1)])])):u("",!0)])])]),i.emails.last_page>1?(n(),o("div",bt,[t("button",{onClick:s[2]||(s[2]=e=>C(i.emails.prev_page_url)),disabled:!i.emails.prev_page_url,class:"w-full sm:w-auto rounded-lg bg-primaryDark px-4 py-2 text-sm font-semibold text-white transition hover:bg-primaryDark/90 disabled:bg-gray-300 disabled:cursor-not-allowed"}," Previous ",8,ft),t("span",vt," Page "+l(i.emails.current_page)+" of "+l(i.emails.last_page),1),t("button",{onClick:s[3]||(s[3]=e=>C(i.emails.next_page_url)),disabled:!i.emails.next_page_url,class:"w-full sm:w-auto rounded-lg bg-primaryDark px-4 py-2 text-sm font-semibold text-white transition hover:bg-primaryDark/90 disabled:bg-gray-300 disabled:cursor-not-allowed"}," Next ",8,ht)])):u("",!0),a.value?(n(),o("div",{key:1,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 p-4",onClick:s[5]||(s[5]=R(e=>a.value=null,["self"]))},[t("div",_t,[t("div",wt,[t("h3",kt,l(a.value.subject),1),t("button",{onClick:s[4]||(s[4]=e=>a.value=null),class:"flex-shrink-0 rounded-lg bg-gray-200 px-3 sm:px-4 py-2 text-sm text-gray-700 hover:bg-gray-300 transition"}," Close ")]),t("div",Ct,[t("div",Dt,[t("p",St,[s[11]||(s[11]=t("strong",null,"To:",-1)),f(" "+l(a.value.patient?.full_name)+" ("+l(a.value.patient_email)+") ",1)]),t("p",null,[s[12]||(s[12]=t("strong",null,"Sent:",-1)),f(" "+l(w(a.value.sent_at)),1)]),t("p",null,[s[13]||(s[13]=t("strong",null,"Status:",-1)),t("span",{class:p([{"text-green-700":a.value.status==="sent","text-red-700":a.value.status==="failed","text-orange-700":a.value.status==="pending","text-primaryDark":a.value.status==="scheduled"},"font-semibold capitalize"])},l(a.value.status),3)]),a.value.delivery_attempts>1?(n(),o("p",jt,[s[14]||(s[14]=t("strong",null,"Delivery Attempts:",-1)),f(" "+l(a.value.delivery_attempts),1)])):u("",!0)]),t("div",$t,[t("p",Ft,l(a.value.message_preview),1)]),a.value.result&&a.value.result.files&&a.value.result.files.length>0?(n(),o("div",zt,[t("h4",Et," Attachments ("+l(a.value.result.files.length)+") ",1),(n(!0),o(m,null,b(a.value.result.files,e=>(n(),o("div",{key:e.id,class:"bg-gray-50 rounded-lg p-4 sm:p-6"},[e.file_type==="image/png"||e.file_type==="image/jpg"||e.file_type==="image/jpeg"?(n(),o("div",Mt,[t("img",{src:e.file_url,alt:e.original_file_name,class:"max-w-full max-h-96 mx-auto rounded-lg shadow"},null,8,Pt),t("div",Bt,[t("p",Nt,l(e.original_file_name),1),t("button",{onClick:d=>h(e),class:"px-4 py-2 font-semibold text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition"}," Download ",8,Vt)])])):e.file_type==="application/pdf"?(n(),o("div",Rt,[t("iframe",{src:e.file_url,class:"w-full h-96 rounded-lg"},null,8,At),t("div",Tt,[t("p",Kt,l(e.original_file_name),1),t("button",{onClick:d=>h(e),class:"px-4 py-2 font-semibold text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition"}," Download PDF ",8,Lt)])])):(n(),o("div",Ut,[s[15]||(s[15]=t("span",{class:"text-4xl sm:text-6xl"},"ðŸ“„",-1)),t("p",qt,l(e.original_file_name),1),t("p",Gt,l(z(e.file_size)),1),t("button",{onClick:d=>h(e),class:"px-4 py-2 font-semibold text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition"}," Download File ",8,Qt)]))]))),128))])):u("",!0)])])])):u("",!0)])])]),_:1})],64))}});export{se as default};
