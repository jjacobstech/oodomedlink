import{r as v,a as x,g as d,e as h,b as i,p as O,w as E,f as r,t as y,o as l,F as w,h as S,i as g,n as V,s as b,q as _,v as C,z as q,l as z,c as M,A as $,y as W}from"./app-DxPBbW_6.js";import{A as G}from"./AuthLayout-hrs0kh7Q.js";import{u as H,o as k,e as D,s as m,_ as J,a as K,f as P}from"./PasswordInput-C6trga_l.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./x-ZULjhb9u.js";import"./index-ClhxbP0C.js";const Q={class:"my-32 py-20 overflow-y-scroll items-center"},X={class:"w-full grid justify-center rounded-xl shadow-xl items-center"},Y={class:"p-6 grid space-y-1 bg-primaryDark rounded-t-lg"},Z={class:"text-center text-xl text-white"},ee={class:"py-6 flex justify-center"},te={class:"flex justify-between items-center px-auto"},re={class:"flex items-center"},ae={class:"p-6 space-y-4"},oe={class:"space-y-2"},se=["disabled"],ie={class:"mt-6 text-center"},le={class:"text-xl text-gray-600"},ne={class:"space-y-2"},de={class:"text-lg text-gray-500 mb-2"},ce=["disabled"],ue={class:"mt-4 text-center"},me=["disabled"],pe=["for"],ye=["id","type","placeholder","autocomplete","onUpdate:modelValue"],he=["disabled"],ke={__name:"Register",setup(ge){const F=W,a=v(!1),c=v(1),{toast:s}=H(),A=sessionStorage.getItem("email"),n=x({email:""}),p=x({otp:"",email:""}),R=v([{id:"clinic_name",name:"Clinic Name",placeholder:"Enter your clinic name",type:"text",required:!0,autocomplete:"organization",model:"clinic_name"},{id:"password",name:"Password",placeholder:"Create a password",type:"password",required:!0,autocomplete:"new-password",model:"password"},{id:"password_confirmation",name:"Confirm Password",placeholder:"Confirm your password",type:"password",required:!0,autocomplete:"new-password",model:"password_confirmation"},{id:"address",name:"Address",placeholder:"Enter your address",type:"text",required:!0,autocomplete:"street-address",model:"address"},{id:"phone_no",name:"Phone Number",placeholder:"Enter your phone number",type:"tel",required:!0,autocomplete:"tel",model:"phone_no"},{id:"country",name:"Country",placeholder:"Enter your country",type:"text",required:!0,autocomplete:"country",model:"country"},{id:"state",name:"State",placeholder:"Enter your state",type:"text",required:!0,autocomplete:"address-level1",model:"state"}]),u=x({email:"",clinic_name:"",password:"",password_confirmation:"",phone_no:"",address:"",state:"",country:""}),N=k({email:D("Invalid email address").min(1,"Email is required")}),T=k({otp:m().length(6,"OTP must be 6 digits"),email:D("Invalid email address")}),U=k({clinic_name:m().min(1,"Clinic name is required"),email:D("Invalid email address"),password:m().min(6,"Password must be at least 6 characters"),password_confirmation:m().min(6,"Password confirmation is required"),phone_no:m().min(1,"Phone number is required"),address:m().min(1,"Address is required"),state:m().min(1,"State is required"),country:m().min(1,"Country is required")}).refine(o=>o.password===o.password_confirmation,{message:"Passwords don't match",path:["password_confirmation"]});n.email=A;const j=async()=>{a.value=!0,sessionStorage.clear();const o=N.safeParse(n);if(!o.success){const e=o.error.errors[0];s({title:"Validation Error",description:e.message,variant:"destructive",class:"text-primaryDark bg-white shadow-lg"}),a.value=!1;return}try{n.post(route("send.otp"),{onSuccess:e=>{s({title:"Verification Code Sent",description:"Please check your email for the verification code",class:"text-primaryDark bg-white shadow-lg"}),c.value=2,p.email=n.email},onError:e=>{s({title:"Error",description:e.email||"Failed to send verification code",variant:"destructive",class:"text-primaryDark bg-white shadow-lg"})}})}catch(e){console.error(e)}a.value=!1},I=async()=>{console.log(p.email),a.value=!0;const o=T.safeParse(p);if(!o.success){for(const e in P(o.error)?.fieldErrors){const t=P(o.error)?.fieldErrors[e][0];s({title:"Validation Error",description:t,variant:"destructive",class:"text-primaryDark bg-white shadow-lg"})}a.value=!1;return}try{p.post(route("verify.otp"),{onSuccess:e=>{s({title:"Email Verified",description:"Please complete your registration",class:"text-primaryDark bg-white shadow-lg"}),u.email=n.email,c.value=3},onError:e=>{s({title:"Verification Failed",description:e.otp||"Invalid verification code",variant:"destructive",class:"text-primaryDark bg-white shadow-lg"}),console.log(e)}})}catch(e){console.error(e)}a.value=!1},B=async()=>{a.value=!0,console.log(p.email);try{n.post(route("send-otp"),{onSuccess:()=>{s({title:"Code Resent",description:"A new verification code has been sent to your email",class:"text-primaryDark bg-white shadow-lg"})},onError:()=>{s({title:"Error",description:"Failed to resend verification code",variant:"destructive",class:"text-primaryDark bg-white shadow-lg"})}})}catch(o){console.error(o)}a.value=!1},L=async()=>{a.value=!0;const o=U.safeParse(u);if(!o.success){const e=o.error.flatten().fieldErrors;for(const t in e){s({title:"Validation Error",description:e[t][0],variant:"destructive",class:"text-primaryDark bg-white shadow-lg"});break}a.value=!1;return}try{u.post(route("signup"),{onFinish:()=>{u.reset()},onError:e=>{for(const t in e){s({title:"Registration Failed",description:e[t],variant:"destructive",class:"text-primaryDark bg-white shadow-lg"});break}},onSuccess:()=>{s({title:"Registration Successful",description:"Welcome! Redirecting to dashboard...",class:"text-primaryDark bg-white shadow-lg"}),setTimeout(()=>{F.push(route("user.dashboard"))},500)}})}catch(e){console.error(e)}a.value=!1};return(o,e)=>(l(),d(w,null,[h(i(O),{title:"signup"}),h(G,null,{default:E(()=>[h(J),r("div",Q,[r("div",X,[r("div",Y,[e[2]||(e[2]=r("h2",{class:"text-2xl font-bold text-center text-white"},"Complete Registration",-1)),r("p",Z," Create an account - Step "+y(c.value)+" of 3 ",1)]),r("div",ee,[r("div",te,[(l(),d(w,null,S(3,t=>r("div",{key:t,class:"flex-1"},[r("div",re,[r("div",{class:V(["w-10 h-10 rounded-full flex items-center justify-center text-2xl font-medium transition-all",c.value>=t?"bg-primaryDark text-white":"bg-gray-200 text-gray-500"])},y(t),3),t<3?(l(),d("div",{key:0,class:V(["flex-1 h-1 mx-2 w-20 transition-all",c.value>t?"bg-primaryDark":"bg-gray-200"])},null,2)):g("",!0)])])),64))])]),r("div",ae,[c.value===1?(l(),d("form",{key:0,onSubmit:b(j,["prevent"]),class:"space-y-4"},[r("div",oe,[e[3]||(e[3]=r("label",{for:"email",class:"text-xl font-medium"},"Email Address",-1)),_(r("input",{id:"email",type:"email",placeholder:"Enter your email",autocomplete:"email",autofocus:"","onUpdate:modelValue":e[0]||(e[0]=t=>i(n).email=t),class:"w-full px-3 py-2 text-lg border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primaryDark"},null,512),[[C,i(n).email]])]),r("button",{type:"submit",class:"w-full px-4 py-2.5 text-xl bg-primaryDark hover:text-primaryDark text-white font-medium rounded-lg hover:bg-white hover:-translate-y-1 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 hover:shadow-md hover:shadow-primaryring-primaryDark/30",disabled:a.value},y(a.value?"Sending OTP...":"Send Verification Code"),9,se),r("div",ie,[r("p",le,[e[5]||(e[5]=q(" Already have an account? ",-1)),h(i(z),{href:"/login",class:"text-primaryring-primaryDark font-medium hover:text-primaryring-primaryDark/80 transition-colors"},{default:E(()=>[...e[4]||(e[4]=[q(" Login ",-1)])]),_:1})])])],32)):g("",!0),c.value===2?(l(),d("form",{key:1,onSubmit:b(I,["prevent"]),class:"space-y-4"},[r("div",ne,[e[6]||(e[6]=r("label",{for:"otp",class:"text-xl font-medium"},"Verification Code",-1)),r("p",de," Enter the 6-digit code sent to "+y(i(n).email),1),_(r("input",{id:"otp",type:"text",placeholder:"Enter 6-digit code",maxlength:"6","onUpdate:modelValue":e[1]||(e[1]=t=>i(p).otp=t),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primaryDark text-center text-2xl tracking-widest"},null,512),[[C,i(p).otp]])]),r("button",{type:"submit",class:"w-full px-4 text-xl py-2.5 bg-primaryDark hover:-translate-y-1 text-white hover:text-primaryDark font-medium rounded-lg hover:bg-white disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 hover:shadow-md hover:shadow-primaryring-primaryDark/30",disabled:a.value},y(a.value?"Verifying...":"Verify Code"),9,ce),r("div",ue,[r("button",{type:"button",onClick:B,class:"text-xl text-primary ring-primaryDark hover:text-primary ring-primaryDark/80 transition-colors",disabled:a.value}," Resend Code ",8,me)])],32)):g("",!0),c.value===3?(l(),d("form",{key:2,onSubmit:b(L,["prevent"]),class:"space-y-4"},[(l(!0),d(w,null,S(R.value,t=>(l(),d("div",{class:"space-y-2",key:t.id},[r("label",{for:t.id,class:"text-xl font-medium"},y(t.name),9,pe),t.type!=="password"?_((l(),d("input",{key:0,id:t.id,type:t.type,placeholder:t.placeholder,autocomplete:t.autocomplete,"onUpdate:modelValue":f=>i(u)[t.model]=f,class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primaryDark"},null,8,ye)),[[$,i(u)[t.model]]]):(l(),M(K,{key:1,id:t.id,placeholder:t.placeholder,modelValue:i(u)[t.model],"onUpdate:modelValue":f=>i(u)[t.model]=f},null,8,["id","placeholder","modelValue","onUpdate:modelValue"]))]))),128)),r("button",{type:"submit",class:"w-full px-4 text-xl py-2.5 bg-primaryDark hover:-translate-y-1 text-white font-medium rounded-lg hover:bg-white hover:text-primaryDark disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 hover:shadow-md hover:shadow-primaryring-primaryDark/30",disabled:a.value},y(a.value?"Signing up...":"Complete Registration"),9,he)],32)):g("",!0)])])])]),_:1})],64))}};export{ke as default};
