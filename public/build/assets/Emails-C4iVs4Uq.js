import{d as $,u as j,r as g,m as S,g as r,e as _,b as E,p as D,w as L,f as t,i as x,n as d,q as V,v as z,o as i,F as c,h,t as o,z as m}from"./app-BVFE2lrP.js";import{_ as F}from"./AuthenticatedLayout.vue_vue_type_script_setup_true_lang-D7LehI4k.js";import"./index-CEhmMyqX.js";import"./x-vP5drbxd.js";import"./index-CkCug2Ue.js";import"./ApplicationLogo.vue_vue_type_script_setup_true_lang-BmW6gCb4.js";import"./Wind-LiKkUfSx-Cwx98uFo.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const N={class:"h-full w-full bg-gray-100"},P={class:"overflow-y-scroll p-6"},R={class:"mb-6 flex flex-col gap-4 md:flex-row md:items-center md:justify-between"},A={class:"flex gap-2"},B={class:"relative"},M={class:"overflow-x-auto rounded-xl bg-white shadow-md"},T={class:"w-full text-sm"},q={class:"divide-y divide-gray-200"},I={class:"px-4 py-3 font-medium text-gray-800"},U={class:"px-4 py-3 text-gray-700"},Q={class:"max-w-[200px] truncate px-4 py-3 text-gray-700"},G={class:"px-4 py-3 text-gray-600"},H={class:"px-4 py-3"},J={class:"px-4 py-3"},K={class:"flex gap-2"},O=["onClick"],W=["onClick"],X={key:0},Y={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"},Z={class:"w-full max-w-4xl p-6 bg-white rounded-xl max-h-[90vh] overflow-y-auto"},tt={class:"mb-4 flex items-center justify-between"},et={class:"text-2xl font-bold text-gray-800"},st={class:"mb-4 text-sm text-gray-600"},lt={class:"rounded-lg bg-gray-50 p-4 text-gray-700"},ot={key:0,class:"text-center"},at=["src"],nt=["onClick"],rt={key:1,class:"text-center"},it=["onClick"],ft=$({__name:"Emails",props:{emails:{}},setup(w){const k=j().props.ziggy.base_url,y=w;console.log(y);const a=g("all"),u=g(""),n=g(null),b=l=>{window.open(`${k}/storage/${l.file_path}`,"_blank")},f=S(()=>{let l=y.emails;if(a.value!=="all"&&(l=l?.filter(e=>e.status===a.value)),u.value){const e=u.value.toLowerCase();l=l?.filter(s=>s.patient.full_name.toLowerCase().includes(e)||s.patient_email.toLowerCase().includes(e)||s.subject.toLowerCase().includes(e))}return l}),v=l=>new Date(l).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),C=l=>{alert(`Retrying email to ${l.patient_email}...`)};return(l,e)=>(i(),r(c,null,[_(E(D),{title:"Email Management"}),_(F,null,{default:L(()=>[t("div",N,[t("div",P,[e[14]||(e[14]=t("div",{class:"mb-6"},[t("h1",{class:"text-3xl font-bold text-gray-800"}," Patient Emails "),t("p",{class:"text-gray-600"}," Monitor and manage all sent emails to patients ")],-1)),t("div",R,[t("div",A,[t("button",{onClick:e[0]||(e[0]=s=>a.value="all"),class:d([a.value==="all"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700","rounded-lg px-4 py-2 font-medium transition-colors"])}," All ",2),t("button",{onClick:e[1]||(e[1]=s=>a.value="in_progress"),class:d([a.value==="in_progress"?"bg-orange-600 text-white":"bg-gray-200 text-gray-700","rounded-lg px-4 py-2 font-medium transition-colors"])}," In Progress ",2),t("button",{onClick:e[2]||(e[2]=s=>a.value="sent"),class:d([a.value==="sent"?"bg-green-600 text-white":"bg-gray-200 text-gray-700","rounded-lg px-4 py-2 font-medium transition-colors"])}," Sent ",2),t("button",{onClick:e[3]||(e[3]=s=>a.value="failed"),class:d([a.value==="failed"?"bg-red-600 text-white":"bg-gray-200 text-gray-700","rounded-lg px-4 py-2 font-medium transition-colors"])}," Failed ",2)]),t("div",B,[V(t("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>u.value=s),type:"text",placeholder:"Search by patient, email, or subject...",class:"w-full rounded-lg border border-gray-300 px-4 py-2 pl-10 focus:border-transparent focus:ring-2 focus:ring-blue-500 md:w-80"},null,512),[[z,u.value]]),e[6]||(e[6]=t("span",{class:"absolute left-3 top-1/2 -translate-y-1/2 transform text-gray-400"},"ðŸ”",-1))])]),t("div",M,[t("table",T,[e[8]||(e[8]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-4 py-3 text-left text-xs font-semibold uppercase text-gray-700"}," Patient "),t("th",{class:"px-4 py-3 text-left text-xs font-semibold uppercase text-gray-700"}," Email "),t("th",{class:"px-4 py-3 text-left text-xs font-semibold uppercase text-gray-700"}," Subject "),t("th",{class:"px-4 py-3 text-left text-xs font-semibold uppercase text-gray-700"}," Sent At "),t("th",{class:"px-4 py-3 text-left text-xs font-semibold uppercase text-gray-700"}," Status "),t("th",{class:"px-4 py-3 text-left text-xs font-semibold uppercase text-gray-700"}," Actions ")])],-1)),t("tbody",q,[(i(!0),r(c,null,h(f.value,s=>(i(),r("tr",{key:s.id,class:"hover:bg-gray-50"},[t("td",I,o(s.patient.full_name),1),t("td",U,o(s.patient.email),1),t("td",Q,o(s.subject),1),t("td",G,o(v(s.sent_at)),1),t("td",H,[t("span",{class:d([{"bg-green-100 text-green-800":s.status==="sent","bg-red-100 text-red-800":s.status==="failed","bg-orange-100 text-orange-800":s.status==="in_progress"},"rounded-full px-3 py-1 text-xs font-semibold capitalize"])},o(s.status.replace("_"," ")),3)]),t("td",J,[t("div",K,[t("button",{onClick:p=>n.value=s,class:"rounded bg-blue-100 px-3 py-1 text-xs font-medium text-blue-700 transition hover:bg-blue-200"}," View ",8,O),s.status==="failed"?(i(),r("button",{key:0,onClick:p=>C(s),class:"rounded bg-red-100 px-3 py-1 text-xs font-medium text-red-700 transition hover:bg-red-200"}," Retry ",8,W)):x("",!0)])])]))),128)),f.value?.length===0?(i(),r("tr",X,[...e[7]||(e[7]=[t("td",{colspan:"6",class:"px-4 py-8 text-center text-gray-500"}," No emails found. ",-1)])])):x("",!0)])])]),n.value?(i(),r("div",Y,[t("div",Z,[t("div",tt,[t("h3",et,o(n.value.subject),1),t("button",{onClick:e[5]||(e[5]=s=>n.value=null),class:"rounded-lg bg-gray-200 px-4 py-2 text-gray-700 hover:bg-gray-300"}," Close ")]),t("div",st,[t("p",null,[e[9]||(e[9]=t("strong",null,"To:",-1)),m(" "+o(n.value.patient.full_name)+" ("+o(n.value.patient_email)+") ",1)]),t("p",null,[e[10]||(e[10]=t("strong",null,"Sent:",-1)),m(" "+o(v(n.value.sent_at)),1)]),t("p",null,[e[11]||(e[11]=t("strong",null,"Status:",-1)),m(" "+o(n.value.status),1)])]),t("div",lt,[t("p",null,o(n.value.message_preview),1)]),(i(!0),r(c,null,h(n.value.result.files,s=>(i(),r("div",{key:s.id,class:"flex items-center justify-center p-8 my-2 bg-gray-100 rounded-lg"},[s.file_type==="image/png"||s.file_type==="image/jpg"||s.file_type==="image/jpeg"?(i(),r("div",ot,[t("img",{src:s.file_url,alt:"Result preview",class:"max-w-full max-h-96"},null,8,at),t("button",{onClick:p=>b(s),class:"px-4 py-2 mt-4 font-semibold text-white bg-blue-600 rounded-lg hover:bg-blue-700"}," Download Image ",8,nt)])):(i(),r("div",rt,[e[12]||(e[12]=t("span",{class:"text-6xl"},"ðŸ“Š",-1)),e[13]||(e[13]=t("p",{class:"mt-4 text-gray-600"}," File",-1)),t("button",{onClick:p=>b(s),class:"px-4 py-2 mt-4 font-semibold text-white bg-blue-600 rounded-lg hover:bg-blue-700"}," Download ",8,it)]))]))),128))])])):x("",!0)])])]),_:1})],64))}});export{ft as default};
