import{r as v,u as w,a as n,b as y,e as i,h as $,w as E,f as r,t as p,o as l,F as b,j as S,g as f,n as V,k as x,i as _,v as C,p as P,x as L,s as M,A as z,m as W}from"./app-keDdQtb0.js";import{u as G,o as k,e as D,s as h,_ as H,a as J,f as F}from"./schemas-DVCNw9OS.js";import{_ as K}from"./AdminAuthLayout.vue_vue_type_script_setup_true_lang-DkQ8aICi.js";import"./x-DaYRpJX1.js";import"./index-B0SnAz0u.js";import"./ApplicationLogo.vue_vue_type_script_setup_true_lang-D6LeLHzi.js";import"./Wind-LiKkUfSx-1_odR1QK.js";const Q={class:"flex h-screen items-center justify-center overflow-y-hidden"},X={class:"max-w-lg items-center justify-center rounded-xl bg-white shadow-xl"},Y={class:"bg-primaryDark grid space-y-1 rounded-t-lg p-6"},Z={class:"text-center text-white"},ee={class:"flex justify-center py-6"},te={class:"px-auto flex items-center justify-between"},re={class:"flex items-center"},ae={class:"space-y-4 p-6"},oe={class:"space-y-2"},se=["disabled"],ie={class:"mt-6 text-center"},le={class:"text-lg text-gray-600"},ne={class:"space-y-2"},de={class:"mb-2 text-xs text-gray-500"},ce=["disabled"],ue={class:"mt-4 text-center"},me=["disabled"],pe=["for"],he=["id","type","placeholder","autocomplete","onUpdate:modelValue"],ye=["disabled"],De={__name:"Register",setup(fe){const q=W,a=v(!1),d=v(1),{toast:s}=G(),R=sessionStorage.getItem("email"),c=w({email:""}),u=w({otp:"",email:""}),j=v([{id:"name",name:"Name",placeholder:"Enter your name",type:"text",required:!0,autocomplete:"organization",model:"name"},{id:"phone_no",name:"Phone Number",placeholder:"Enter your phone number",type:"tel",required:!0,autocomplete:"tel",model:"phone_no"},{id:"password",name:"Password",placeholder:"Create a password",type:"password",required:!0,autocomplete:"new-password",model:"password"},{id:"password_confirmation",name:"Confirm Password",placeholder:"Confirm your password",type:"password",required:!0,autocomplete:"new-password",model:"password_confirmation"}]),m=w({email:"",name:"",phone_no:"",password:"",password_confirmation:""}),N=k({email:D("Invalid email address").min(1,"Email is required")}),T=k({otp:h().length(6,"OTP must be 6 digits"),email:D("Invalid email address")}),U=k({name:h().min(1,"Clinic name is required"),email:D("Invalid email address"),phone_no:h().min(1,"Phone number is required"),password:h().min(6,"Password must be at least 6 characters"),password_confirmation:h().min(6,"Password confirmation is required")}).refine(o=>o.password===o.password_confirmation,{message:"Passwords don't match",path:["password_confirmation"]});c.email=R;const I=async()=>{a.value=!0,sessionStorage.clear();const o=N.safeParse(c);if(!o.success){const e=o.error.errors[0];s({title:"Validation Error",description:e.message,variant:"destructive",class:"text-primaryDark bg-white shadow-lg"}),a.value=!1;return}try{c.post(route("admin.send.otp"),{onSuccess:e=>{s({title:"Verification Code Sent",description:"Please check your email for the verification code",class:"text-primaryDark bg-white shadow-lg"}),d.value=2,u.email=c.email},onError:e=>{s({title:"Error",description:e.email||"Failed to send verification code",variant:"destructive",class:"text-primaryDark bg-white shadow-lg"}),a.value=!1}})}catch(e){console.error(e)}a.value=!1},A=async()=>{console.log(u.email),a.value=!0;const o=T.safeParse(u);if(!o.success){for(const e in F(o.error)?.fieldErrors){const t=F(o.error)?.fieldErrors[e][0];s({title:"Validation Error",description:t,variant:"destructive",class:"text-primaryDark bg-white shadow-lg"})}a.value=!1;return}try{u.post(route("admin.verify.otp"),{onSuccess:e=>{s({title:"Email Verified",description:"Please complete your registration",class:"text-primaryDark bg-white shadow-lg"}),m.email=u.email,d.value=3},onError:e=>{s({title:"Verification Failed",description:e.otp||"Invalid verification code",variant:"destructive",class:"text-primaryDark bg-white shadow-lg"}),console.log(e)}})}catch(e){console.error(e)}a.value=!1},B=async()=>{a.value=!0,console.log(u.email);try{c.post(route("admin.send-otp"),{onSuccess:()=>{s({title:"Code Resent",description:"A new verification code has been sent to your email",class:"text-primaryDark bg-white shadow-lg"})},onError:()=>{s({title:"Error",description:"Failed to resend verification code",variant:"destructive",class:"text-primaryDark bg-white shadow-lg"})}})}catch(o){console.error(o)}a.value=!1},O=async()=>{a.value=!0,console.log(m.email);const o=U.safeParse(m);if(!o.success){const e=o.error.flatten().fieldErrors;for(const t in e){s({title:"Validation Error",description:e[t][0],variant:"destructive",class:"text-primaryDark bg-white shadow-lg"});break}a.value=!1;return}try{m.post(route("admin.signup"),{onError:e=>{for(const t in e){s({title:"Registration Failed",description:e[t],variant:"destructive",class:"text-primaryDark bg-white shadow-lg"});break}},onSuccess:()=>{s({title:"Registration Successful",description:"Welcome! Redirecting to dashboard...",class:"text-primaryDark bg-white shadow-lg"}),setTimeout(()=>{q.push(route("admin.dashoard"))},500)}})}catch(e){console.error(e)}a.value=!1};return(o,e)=>(l(),n(b,null,[y(i($),{title:"signup"}),y(K,null,{default:E(()=>[y(H),r("div",Q,[r("div",X,[r("div",Y,[e[2]||(e[2]=r("h2",{class:"text-center text-2xl font-bold text-white"}," Complete Registration ",-1)),r("p",Z," Create an account - Step "+p(d.value)+" of 3 ",1)]),r("div",ee,[r("div",te,[(l(),n(b,null,S(3,t=>r("div",{key:t,class:"flex-1"},[r("div",re,[r("div",{class:V(["flex h-8 w-8 items-center justify-center rounded-full text-lg font-extrabold transition-all",d.value>=t?"bg-primaryDark text-white":"bg-gray-200 text-gray-500"])},p(t),3),t<3?(l(),n("div",{key:0,class:V(["mx-2 h-1 w-20 flex-1 transition-all",d.value>t?"bg-primaryDark":"bg-gray-200"])},null,2)):f("",!0)])])),64))])]),r("div",ae,[d.value===1?(l(),n("form",{key:0,onSubmit:x(I,["prevent"]),class:"space-y-4"},[r("div",oe,[e[3]||(e[3]=r("label",{for:"email",class:"text-lg font-extrabold"},"Email Address",-1)),_(r("input",{id:"email",type:"email",placeholder:"Enter your email",autocomplete:"email",autofocus:"","onUpdate:modelValue":e[0]||(e[0]=t=>i(c).email=t),class:"focus:ring-primaryDark w-full rounded-md border border-gray-300 px-3 py-2 focus:outline-none focus:ring-2"},null,512),[[C,i(c).email]])]),r("button",{type:"submit",class:"bg-primaryDark hover:shadow-primaryDark/30 w-full rounded-lg px-4 py-2.5 font-extrabold text-white transition-all duration-200 hover:-translate-y-1 hover:bg-white hover:shadow-md disabled:cursor-not-allowed disabled:opacity-50",disabled:a.value},p(a.value?"Sending OTP...":"Send Verification Code"),9,se),r("div",ie,[r("p",le,[e[5]||(e[5]=P(" Already have an account? ",-1)),y(i(L),{href:o.route("admin.login"),class:"text-primaryDark hover:text-primaryDark/80 font-extrabold transition-colors"},{default:E(()=>[...e[4]||(e[4]=[P(" Login ",-1)])]),_:1},8,["href"])])])],32)):f("",!0),d.value===2?(l(),n("form",{key:1,onSubmit:x(A,["prevent"]),class:"space-y-4"},[r("div",ne,[e[6]||(e[6]=r("label",{for:"otp",class:"text-lg font-extrabold"},"Verification Code",-1)),r("p",de," Enter the 6-digit code sent to "+p(i(c).email),1),_(r("input",{id:"otp",type:"text",placeholder:"Enter 6-digit code",maxlength:"6","onUpdate:modelValue":e[1]||(e[1]=t=>i(u).otp=t),class:"focus:ring-primaryDark w-full rounded-md border border-gray-300 px-3 py-2 text-center text-2xl tracking-widest focus:outline-none focus:ring-2"},null,512),[[C,i(u).otp]])]),r("button",{type:"submit",class:"bg-primaryDark hover:shadow-primaryDark/30 w-full rounded-lg px-4 py-2.5 font-extrabold text-white transition-all duration-200 hover:-translate-y-1 hover:bg-white hover:shadow-md disabled:cursor-not-allowed disabled:opacity-50",disabled:a.value},p(a.value?"Verifying...":"Verify Code"),9,ce),r("div",ue,[r("button",{type:"button",onClick:B,class:"text-primaryDark hover:text-primaryDark/80 text-lg transition-colors",disabled:a.value}," Resend Code ",8,me)])],32)):f("",!0),d.value===3?(l(),n("form",{key:2,onSubmit:x(O,["prevent"]),class:"h-full space-y-4"},[(l(!0),n(b,null,S(j.value,t=>(l(),n("div",{class:"space-y-2",key:t.id},[r("label",{for:t.id,class:"text-lg font-extrabold"},p(t.name),9,pe),t.type!=="password"?_((l(),n("input",{key:0,id:t.id,type:t.type,placeholder:t.placeholder,autocomplete:t.autocomplete,"onUpdate:modelValue":g=>i(m)[t.model]=g,class:"focus:ring-primaryDark w-full rounded-md border border-gray-300 px-3 py-2 focus:outline-none focus:ring-2"},null,8,he)),[[z,i(m)[t.model]]]):(l(),M(J,{key:1,id:t.id,placeholder:t.placeholder,modelValue:i(m)[t.model],"onUpdate:modelValue":g=>i(m)[t.model]=g},null,8,["id","placeholder","modelValue","onUpdate:modelValue"]))]))),128)),r("button",{type:"submit",class:"bg-primaryDark hover:shadow-primaryDark/30 w-full rounded-lg px-4 py-2.5 font-extrabold text-white transition-all duration-200 hover:-translate-y-1 hover:bg-white hover:shadow-md disabled:cursor-not-allowed disabled:opacity-50",disabled:a.value},p(a.value?"Signing up...":"Complete Registration"),9,ye)],32)):f("",!0)])])])]),_:1})],64))}};export{De as default};
