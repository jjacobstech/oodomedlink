import{r as f,a as v,g as d,e as y,f as t,q as g,b as i,p as O,w as S,t as m,o as n,F as w,h as V,s as b,z as _,v as k,x as C,y as P,l as $,c as z,A as M,m as W}from"./app-C9oXBKpJ.js";import{o as D,e as E,s as h,_ as G,f as F}from"./schemas-DSJSzaL0.js";import{_ as H}from"./AdminAuthLayout.vue_vue_type_script_setup_true_lang-BtofwS70.js";import{u as J,_ as K}from"./index-B0_7G_O2.js";import"./createLucideIcon-BVA0rSSJ.js";import"./index-CIdzAFPz.js";import"./x-DdcIIY5e.js";const Q={class:"flex h-screen items-center justify-center overflow-y-hidden"},X={class:"max-w-lg items-center justify-center rounded-xl bg-white shadow-xl"},Y={class:"bg-primaryDark grid space-y-1 rounded-t-lg p-6"},Z={class:"text-center text-white"},ee={class:"flex justify-center py-6"},te={class:"px-auto flex items-center justify-between"},ae={class:"flex items-center"},re={class:"space-y-4 p-6"},se={class:"space-y-2"},oe=["disabled"],ie={class:"mt-6 text-center"},le={class:"text-lg text-gray-600"},ne={class:"space-y-2"},de={class:"mb-2 text-xs text-gray-500"},ce=["disabled"],me={class:"mt-4 text-center"},ue=["disabled"],pe={key:0,class:"flex min-h-screen w-full justify-center overflow-y-auto bg-primaryLight pb-20 pt-6 sm:pt-10"},he={class:"mx-4 my-auto h-fit w-full max-w-sm rounded-xl bg-white shadow-lg sm:mx-6 sm:max-w-md md:max-w-lg lg:mx-8 lg:max-w-2xl xl:max-w-4xl 2xl:max-w-6xl"},ye={class:"grid space-y-1 rounded-t-xl bg-primaryDark px-4 py-4 sm:py-5"},ge={class:"text-center text-sm text-white sm:text-base lg:text-lg"},xe=["for"],fe=["id","type","placeholder","autocomplete","onUpdate:modelValue"],ve=["disabled"],Ce={__name:"Register",setup(we){const q=W,r=f(!1),l=f(1),{toast:o}=J(),R=sessionStorage.getItem("email"),c=v({email:""}),p=v({otp:"",email:""}),j=f([{id:"name",name:"Name",placeholder:"Enter your name",type:"text",required:!0,autocomplete:"organization",model:"name"},{id:"phone_no",name:"Phone Number",placeholder:"Enter your phone number",type:"tel",required:!0,autocomplete:"tel",model:"phone_no"},{id:"password",name:"Password",placeholder:"Create a password",type:"password",required:!0,autocomplete:"new-password",model:"password"},{id:"password_confirmation",name:"Confirm Password",placeholder:"Confirm your password",type:"password",required:!0,autocomplete:"new-password",model:"password_confirmation"}]),u=v({email:"",name:"",phone_no:"",password:"",password_confirmation:""}),N=D({email:E("Invalid email address").min(1,"Email is required")}),T=D({otp:h().length(6,"OTP must be 6 digits"),email:E("Invalid email address")}),U=D({name:h().min(1,"Clinic name is required"),email:E("Invalid email address"),phone_no:h().min(1,"Phone number is required"),password:h().min(6,"Password must be at least 6 characters"),password_confirmation:h().min(6,"Password confirmation is required")}).refine(s=>s.password===s.password_confirmation,{message:"Passwords don't match",path:["password_confirmation"]});c.email=R;const I=async()=>{r.value=!0,sessionStorage.clear();const s=N.safeParse(c);if(!s.success){const e=s.error.errors[0];o({title:"Validation Error",description:e.message,variant:"destructive",class:"text-primaryDark bg-white shadow-lg"}),r.value=!1;return}try{c.post(route("admin.send.otp"),{onSuccess:e=>{o({title:"Verification Code Sent",description:"Please check your email for the verification code",class:"text-primaryDark bg-white shadow-lg"}),l.value=2,p.email=c.email},onError:e=>{o({title:"Error",description:e.email||"Failed to send verification code",variant:"destructive",class:"text-primaryDark bg-white shadow-lg"}),r.value=!1}})}catch{}r.value=!1},A=async()=>{r.value=!0;const s=T.safeParse(p);if(!s.success){for(const e in F(s.error)?.fieldErrors){const a=F(s.error)?.fieldErrors[e][0];o({title:"Validation Error",description:a,variant:"destructive",class:"text-primaryDark bg-white shadow-lg"})}r.value=!1;return}try{p.post(route("admin.verify.otp"),{onSuccess:e=>{o({title:"Email Verified",description:"Please complete your registration",class:"text-primaryDark bg-white shadow-lg"}),u.email=p.email,l.value=3},onError:e=>{o({title:"Verification Failed",description:e.otp||"Invalid verification code",variant:"destructive",class:"text-primaryDark bg-white shadow-lg"})}})}catch{}r.value=!1},B=async()=>{r.value=!0;try{c.post(route("admin.send-otp"),{onSuccess:()=>{o({title:"Code Resent",description:"A new verification code has been sent to your email",class:"text-primaryDark bg-white shadow-lg"})},onError:()=>{o({title:"Error",description:"Failed to resend verification code",variant:"destructive",class:"text-primaryDark bg-white shadow-lg"})}})}catch{}r.value=!1},L=async()=>{r.value=!0;const s=U.safeParse(u);if(!s.success){const e=s.error.flatten().fieldErrors;for(const a in e){o({title:"Validation Error",description:e[a][0],variant:"destructive",class:"text-primaryDark bg-white shadow-lg"});break}r.value=!1;return}try{u.post(route("admin.signup"),{onError:e=>{for(const a in e){o({title:"Registration Failed",description:e[a],variant:"destructive",class:"text-primaryDark bg-white shadow-lg"});break}},onSuccess:()=>{o({title:"Registration Successful",description:"Welcome! Redirecting to dashboard...",class:"text-primaryDark bg-white shadow-lg"}),setTimeout(()=>{q.push(route("admin.dashoard"))},500)}})}catch{}r.value=!1};return(s,e)=>(n(),d(w,null,[y(i(O),{title:"signup"}),t("div",{class:b(l.value!==3?"block":"hidden")},[y(H,null,{default:S(()=>[y(K),t("div",Q,[t("div",X,[t("div",Y,[e[2]||(e[2]=t("h2",{class:"text-center text-2xl font-bold text-white"}," Complete Registration ",-1)),t("p",Z," Create an account - Step "+m(l.value)+" of 3 ",1)]),t("div",ee,[t("div",te,[(n(),d(w,null,V(3,a=>t("div",{key:a,class:"flex-1"},[t("div",ae,[t("div",{class:b(["flex h-8 w-8 items-center justify-center rounded-full text-lg font-extrabold transition-all",l.value>=a?"bg-primaryDark text-white":"bg-gray-200 text-gray-500"])},m(a),3),a<3?(n(),d("div",{key:0,class:b(["mx-2 h-1 w-20 flex-1 transition-all",l.value>a?"bg-primaryDark":"bg-gray-200"])},null,2)):g("",!0)])])),64))])]),t("div",re,[l.value===1?(n(),d("form",{key:0,onSubmit:_(I,["prevent"]),class:"space-y-4"},[t("div",se,[e[3]||(e[3]=t("label",{for:"email",class:"text-lg font-extrabold"},"Email Address",-1)),k(t("input",{id:"email",type:"email",placeholder:"Enter your email",autocomplete:"email",autofocus:"","onUpdate:modelValue":e[0]||(e[0]=a=>i(c).email=a),class:"focus:ring-primaryDark w-full rounded-md border border-gray-300 px-3 py-2 focus:outline-none focus:ring-2"},null,512),[[C,i(c).email]])]),t("button",{type:"submit",class:"bg-primaryDark hover:shadow-primaryDark/30 w-full rounded-lg px-4 py-2.5 font-extrabold text-white transition-all duration-200 hover:-translate-y-1 hover:bg-white hover:shadow-md disabled:cursor-not-allowed disabled:opacity-50",disabled:r.value},m(r.value?"Sending OTP...":"Send Verification Code"),9,oe),t("div",ie,[t("p",le,[e[5]||(e[5]=P(" Already have an account? ",-1)),y(i($),{href:s.route("admin.login"),class:"text-primaryDark hover:text-primaryDark/80 font-extrabold transition-colors"},{default:S(()=>[...e[4]||(e[4]=[P(" Login ",-1)])]),_:1},8,["href"])])])],32)):g("",!0),l.value===2?(n(),d("form",{key:1,onSubmit:_(A,["prevent"]),class:"space-y-4"},[t("div",ne,[e[6]||(e[6]=t("label",{for:"otp",class:"text-lg font-extrabold"},"Verification Code",-1)),t("p",de," Enter the 6-digit code sent to "+m(i(c).email),1),k(t("input",{id:"otp",type:"text",placeholder:"Enter 6-digit code",maxlength:"6","onUpdate:modelValue":e[1]||(e[1]=a=>i(p).otp=a),class:"focus:ring-primaryDark w-full rounded-md border border-gray-300 px-3 py-2 text-center text-2xl tracking-widest focus:outline-none focus:ring-2"},null,512),[[C,i(p).otp]])]),t("button",{type:"submit",class:"bg-primaryDark hover:shadow-primaryDark/30 w-full rounded-lg px-4 py-2.5 font-extrabold text-white transition-all duration-200 hover:-translate-y-1 hover:bg-white hover:shadow-md disabled:cursor-not-allowed disabled:opacity-50",disabled:r.value},m(r.value?"Verifying...":"Verify Code"),9,ce),t("div",me,[t("button",{type:"button",onClick:B,class:"text-primaryDark hover:text-primaryDark/80 text-lg transition-colors",disabled:r.value}," Resend Code ",8,ue)])],32)):g("",!0)])])])]),_:1})],2),l.value===3?(n(),d("div",pe,[t("div",he,[t("div",ye,[e[7]||(e[7]=t("h2",{class:"text-center text-xl font-bold text-white sm:text-2xl lg:text-3xl"}," Complete Registration ",-1)),t("p",ge," Create an account - Step "+m(l.value)+" of 3 ",1)]),t("form",{onSubmit:_(L,["prevent"]),class:"space-y-3 p-4 sm:space-y-4 sm:p-6 lg:p-8"},[(n(!0),d(w,null,V(j.value,a=>(n(),d("div",{class:"space-y-1.5 sm:space-y-2",key:a.id},[t("label",{for:a.id,class:"block text-sm font-medium text-gray-700 sm:text-base lg:text-lg"},m(a.name),9,xe),a.type!=="password"?k((n(),d("input",{key:0,id:a.id,type:a.type,placeholder:a.placeholder,autocomplete:a.autocomplete,"onUpdate:modelValue":x=>i(u)[a.model]=x,class:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm transition-all focus:border-transparent focus:outline-none focus:ring-2 focus:ring-primaryDark sm:py-2.5 sm:text-base"},null,8,fe)),[[M,i(u)[a.model]]]):(n(),z(G,{key:1,id:a.id,placeholder:a.placeholder,modelValue:i(u)[a.model],"onUpdate:modelValue":x=>i(u)[a.model]=x},null,8,["id","placeholder","modelValue","onUpdate:modelValue"]))]))),128)),t("button",{type:"submit",class:"mt-6 w-full rounded-lg bg-primaryDark px-4 py-2.5 text-sm font-medium text-white transition-all duration-200 hover:-translate-y-1 hover:bg-white hover:text-primaryDark hover:shadow-lg hover:shadow-primaryDark/30 disabled:cursor-not-allowed disabled:opacity-50 sm:py-3 sm:text-base lg:text-lg",disabled:r.value},m(r.value?"Signing up...":"Complete Registration"),9,ve)],32)])])):g("",!0)],64))}};export{Ce as default};
