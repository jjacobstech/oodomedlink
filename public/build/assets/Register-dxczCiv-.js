import{r as f,a as v,g as c,e as h,i as g,b as o,p as O,w,f as t,l as C,t as u,o as n,F as b,h as V,n as _,s as k,q as D,v as q,z as P,c as M,A as $,y as H}from"./app-Ji7o7nMj.js";import{u as W,o as E,e as S,s as p,_ as G,a as J,f as F}from"./schemas-BNnj_p_T.js";import{A as K}from"./AuthLayout-CFDdfzTp.js";import{z as Q}from"./Wind-LiKkUfSx-CajI83YB.js";import"./x-DaoxGN1F.js";import"./index-oC-JvPDr.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const X={class:"container relative z-10 mx-auto flex min-h-[calc(100vh-80px)] items-center justify-center py-12 lg:max-w-xl"},Y={class:"w-full space-y-4 px-7 lg:px-20"},Z={class:"grid w-full items-center justify-center rounded-xl bg-white shadow-xl"},ee={class:"grid space-y-1 rounded-t-lg bg-primaryDark p-6"},te={class:"text-center text-xl text-white"},re={class:"flex justify-center bg-white px-4 py-6 lg:px-0"},ae={class:"px-auto flex items-center justify-between"},se={class:"flex items-center"},oe={class:"space-y-4 bg-white p-6"},ie={class:"space-y-2"},le=["disabled"],ne={class:"mt-6 text-center"},de={class:"text-xl text-gray-600"},ce={class:"space-y-2"},me={class:"mb-2 text-gray-500 lg:text-lg"},ue=["disabled"],pe={class:"mt-4 text-center"},ye=["disabled"],he={key:0,class:"flex min-h-screen w-full justify-center overflow-y-auto bg-primaryLight pb-20 pt-6 sm:pt-10"},ge={class:"mx-4 my-auto h-fit w-full max-w-sm rounded-xl bg-white shadow-lg sm:mx-6 sm:max-w-md md:max-w-lg lg:mx-8 lg:max-w-2xl xl:max-w-4xl 2xl:max-w-6xl"},xe={class:"grid space-y-1 rounded-t-xl bg-primaryDark px-4 py-4 sm:py-5"},fe={class:"text-center text-sm text-white sm:text-base lg:text-lg"},ve=["for"],we=["id","type","placeholder","autocomplete","onUpdate:modelValue"],be=["disabled"],Pe={__name:"Register",setup(_e){const R=H,a=f(!1),l=f(1),{toast:i}=W(),A=sessionStorage.getItem("email"),d=v({email:""}),y=v({otp:"",email:""}),j=f([{id:"clinic_name",name:"Clinic Name",placeholder:"Enter your clinic name",type:"text",required:!0,autocomplete:"organization",model:"clinic_name"},{id:"password",name:"Password",placeholder:"Create a password",type:"password",required:!0,autocomplete:"new-password",model:"password"},{id:"password_confirmation",name:"Confirm Password",placeholder:"Confirm your password",type:"password",required:!0,autocomplete:"new-password",model:"password_confirmation"},{id:"address",name:"Address",placeholder:"Enter your address",type:"text",required:!0,autocomplete:"street-address",model:"address"},{id:"phone_no",name:"Phone Number",placeholder:"Enter your phone number",type:"tel",required:!0,autocomplete:"tel",model:"phone_no"},{id:"country",name:"Country",placeholder:"Enter your country",type:"text",required:!0,autocomplete:"country",model:"country"},{id:"state",name:"State",placeholder:"Enter your state",type:"text",required:!0,autocomplete:"address-level1",model:"state"}]),m=v({email:"",clinic_name:"",password:"",password_confirmation:"",phone_no:"",address:"",state:"",country:""}),N=E({email:S("Invalid email address").min(1,"Email is required")}),T=E({otp:p().length(6,"OTP must be 6 digits"),email:S("Invalid email address")}),U=E({clinic_name:p().min(1,"Clinic name is required"),email:S("Invalid email address"),password:p().min(6,"Password must be at least 6 characters"),password_confirmation:p().min(6,"Password confirmation is required"),phone_no:p().min(1,"Phone number is required"),address:p().min(1,"Address is required"),state:p().min(1,"State is required"),country:p().min(1,"Country is required")}).refine(s=>s.password===s.password_confirmation,{message:"Passwords don't match",path:["password_confirmation"]});d.email=A;const z=async()=>{a.value=!0,sessionStorage.clear();const s=N.safeParse(d);if(!s.success){const e=s.error.errors[0];i({title:"Validation Error",description:e.message,variant:"destructive",class:"text-primaryDark bg-white shadow-lg"}),a.value=!1;return}try{d.post(route("send.otp"),{onSuccess:e=>{i({title:"Verification Code Sent",description:"Please check your email for the verification code",class:"text-primaryDark bg-white shadow-lg"}),l.value=2,y.email=d.email},onError:e=>{i({title:"Error",description:e.email||"Failed to send verification code",variant:"destructive",class:"text-primaryDark bg-white shadow-lg"})}})}catch(e){console.error(e)}a.value=!1},B=async()=>{console.log(y.email),a.value=!0;const s=T.safeParse(y);if(!s.success){for(const e in F(s.error)?.fieldErrors){const r=F(s.error)?.fieldErrors[e][0];i({title:"Validation Error",description:r,variant:"destructive",class:"text-primaryDark bg-white shadow-lg"})}a.value=!1;return}try{y.post(route("verify.otp"),{onSuccess:e=>{i({title:"Email Verified",description:"Please complete your registration",class:"text-primaryDark bg-white shadow-lg"}),m.email=d.email,l.value=3},onError:e=>{i({title:"Verification Failed",description:e.otp||"Invalid verification code",variant:"destructive",class:"text-primaryDark bg-white shadow-lg"}),console.log(e)}})}catch(e){console.error(e)}a.value=!1},I=async()=>{a.value=!0,console.log(y.email);try{d.post(route("send.otp"),{onSuccess:()=>{i({title:"Code Resent",description:"A new verification code has been sent to your email",class:"text-primaryDark bg-white shadow-lg"})},onError:()=>{i({title:"Error",description:"Failed to resend verification code",variant:"destructive",class:"text-primaryDark bg-white shadow-lg"})}})}catch(s){console.error(s)}a.value=!1},L=async()=>{a.value=!0;const s=U.safeParse(m);if(!s.success){const e=s.error.flatten().fieldErrors;for(const r in e){i({title:"Validation Error",description:e[r][0],variant:"destructive",class:"text-primaryDark bg-white shadow-lg"});break}a.value=!1;return}try{m.post(route("signup"),{onFinish:()=>{m.reset()},onError:e=>{for(const r in e){i({title:"Registration Failed",description:e[r],variant:"destructive",class:"text-primaryDark bg-white shadow-lg"});break}},onSuccess:()=>{i({title:"Registration Successful",description:"Welcome! Redirecting to dashboard...",class:"text-primaryDark bg-white shadow-lg"}),setTimeout(()=>{R.push(route("user.dashboard"))},500)}})}catch(e){console.error(e)}a.value=!1};return(s,e)=>(n(),c(b,null,[h(o(O),{title:"signup"}),h(K,{class:_(l.value!==3?"block":"hidden")},{default:w(()=>[h(G),t("div",X,[t("div",Y,[h(o(C),{href:"/",class:"inline-flex items-center gap-2 rounded-lg px-4 py-2 text-xl text-primaryDark transition-all duration-200 hover:-translate-y-0.5 hover:bg-primaryDark hover:text-white hover:shadow-lg hover:shadow-primaryDark/30"},{default:w(()=>[h(o(Q),{class:"h-5 w-5"}),e[2]||(e[2]=t("span",null,"Back to Home",-1))]),_:1}),t("div",Z,[t("div",ee,[e[3]||(e[3]=t("h2",{class:"text-center font-bold text-white lg:text-2xl"}," Complete Registration ",-1)),t("p",te," Create an account - Step "+u(l.value)+" of 3 ",1)]),t("div",re,[t("div",ae,[(n(),c(b,null,V(3,r=>t("div",{key:r,class:"flex-1"},[t("div",se,[t("div",{class:_(["flex h-10 w-10 items-center justify-center rounded-full text-2xl font-medium transition-all",l.value>=r?"bg-primaryDark text-white":"bg-gray-200 text-gray-500"])},u(r),3),r<3?(n(),c("div",{key:0,class:_(["mx-2 h-1 w-20 flex-1 transition-all",l.value>r?"bg-primaryDark":"bg-gray-200"])},null,2)):g("",!0)])])),64))])]),t("div",oe,[l.value===1?(n(),c("form",{key:0,onSubmit:k(z,["prevent"]),class:"space-y-4"},[t("div",ie,[e[4]||(e[4]=t("label",{for:"email",class:"text-xl font-medium"},"Email Address",-1)),D(t("input",{id:"email",type:"email",placeholder:"Enter your email",autocomplete:"email",autofocus:"","onUpdate:modelValue":e[0]||(e[0]=r=>o(d).email=r),class:"w-full rounded-md border border-gray-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primaryDark lg:text-lg"},null,512),[[q,o(d).email]])]),t("button",{type:"submit",class:"hover:shadow-primaryring-primaryDark/30 w-full rounded-lg bg-primaryDark px-4 py-2.5 text-xl font-medium text-white transition-all duration-200 hover:-translate-y-1 hover:bg-white hover:text-primaryDark hover:shadow-md disabled:cursor-not-allowed disabled:opacity-50",disabled:a.value},u(a.value?"Sending OTP...":"Send Verification Code"),9,le),t("div",ne,[t("p",de,[e[6]||(e[6]=P(" Already have an account? ",-1)),h(o(C),{href:s.route("login"),class:"text-primaryring-primaryDark hover:text-primaryring-primaryDark/80 font-medium transition-colors"},{default:w(()=>[...e[5]||(e[5]=[P(" Login ",-1)])]),_:1},8,["href"])])])],32)):g("",!0),l.value===2?(n(),c("form",{key:1,onSubmit:k(B,["prevent"]),class:"space-y-4"},[t("div",ce,[e[7]||(e[7]=t("label",{for:"otp",class:"font-medium lg:text-xl"},"Verification Code",-1)),t("p",me," Enter the 6-digit code sent to "+u(o(d).email),1),D(t("input",{id:"otp",type:"text",placeholder:"Enter 6-digit code",maxlength:"6","onUpdate:modelValue":e[1]||(e[1]=r=>o(y).otp=r),class:"w-full rounded-md border border-gray-300 px-3 py-2 text-center text-2xl tracking-widest focus:outline-none focus:ring-2 focus:ring-primaryDark"},null,512),[[q,o(y).otp]])]),t("button",{type:"submit",class:"hover:shadow-primaryring-primaryDark/30 w-full rounded-lg bg-primaryDark px-4 py-2.5 font-medium text-white transition-all duration-200 hover:-translate-y-1 hover:bg-white hover:text-primaryDark hover:shadow-md disabled:cursor-not-allowed disabled:opacity-50 lg:text-xl",disabled:a.value},u(a.value?"Verifying...":"Verify Code"),9,ue),t("div",pe,[t("button",{type:"button",onClick:I,class:"text-primary ring-primaryDark ring-primaryDark/80 transition-colors hover:text-primary lg:text-xl",disabled:a.value}," Resend Code ",8,ye)])],32)):g("",!0)])])])])]),_:1},8,["class"]),l.value===3?(n(),c("div",he,[t("div",ge,[t("div",xe,[e[8]||(e[8]=t("h2",{class:"text-center text-xl font-bold text-white sm:text-2xl lg:text-3xl"}," Complete Registration ",-1)),t("p",fe," Create an account - Step "+u(l.value)+" of 3 ",1)]),t("form",{onSubmit:k(L,["prevent"]),class:"space-y-3 p-4 sm:space-y-4 sm:p-6 lg:p-8"},[(n(!0),c(b,null,V(j.value,r=>(n(),c("div",{class:"space-y-1.5 sm:space-y-2",key:r.id},[t("label",{for:r.id,class:"block text-sm font-medium text-gray-700 sm:text-base lg:text-lg"},u(r.name),9,ve),r.type!=="password"?D((n(),c("input",{key:0,id:r.id,type:r.type,placeholder:r.placeholder,autocomplete:r.autocomplete,"onUpdate:modelValue":x=>o(m)[r.model]=x,class:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm transition-all focus:border-transparent focus:outline-none focus:ring-2 focus:ring-primaryDark sm:py-2.5 sm:text-base"},null,8,we)),[[$,o(m)[r.model]]]):(n(),M(J,{key:1,id:r.id,placeholder:r.placeholder,modelValue:o(m)[r.model],"onUpdate:modelValue":x=>o(m)[r.model]=x},null,8,["id","placeholder","modelValue","onUpdate:modelValue"]))]))),128)),t("button",{type:"submit",class:"mt-6 w-full rounded-lg bg-primaryDark px-4 py-2.5 text-sm font-medium text-white transition-all duration-200 hover:-translate-y-1 hover:bg-white hover:text-primaryDark hover:shadow-lg hover:shadow-primaryDark/30 disabled:cursor-not-allowed disabled:opacity-50 sm:py-3 sm:text-base lg:text-lg",disabled:a.value},u(a.value?"Signing up...":"Complete Registration"),9,be)],32)])])):g("",!0)],64))}};export{Pe as default};
